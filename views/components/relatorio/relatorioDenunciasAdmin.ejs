 <div class="container">
      <div class="filtragem">
        <div><span>Filtrar Relatório</span></div>
        <form class="row">
          <div class="col-lg-3 mb-3">
            <legend>Status:</legend>
            <select class="custom-select" id="formStatusmyInput" name="status">
              <option selected value="">Todas</option>
              <option value="0">Cancelada</option>
              <option value="1">Submetida</option>
              <option value="2">Em Revisão</option>
              <option value="3">Aprovada</option>
              <option value="4">Solucionada</option>
            </select>
          </div>

          <div class="col-lg-3">
            <legend>Data de Submissão:</legend>
            <select class="custom-select" id="formStatus" name="data">
              <option selected value="">Todas</option>
              <option value="0">Hoje</option>
              <option value="1">Ontem</option>
              <option value="2">Nesta Semana</option>
              <option value="3">Semana Passada</option>
              <option value="4">Mês passado</option>
            </select>
          </div>

          <div class="col-lg-3">
            <button type="button" class="btn btn-primary" onclick="filtrar()">Filtrar</button>
          </div>
        </form>
      </div>

      <div>
        <table class="table table-bordered table-responsive table-striped" id="tabelaDenuncias">
          <thead>
            <tr>
              <th>Email</th>
              <th>Responsável</th>
              <th>Data</th>
              <th>Descrição</th>
              <th>Visibilidade</th>
              <th>Status</th>
              <th>Observação</th>
            </tr>
          </thead>
          <tbody class="tableMembroAutenticado">
           <% denuncias.forEach(denuncia => { %>
            <tr>
              <td class="align-middle"><%=  denuncia.email %></td>
              <td class="nomeFormat align-middle">
                <form>
                  <div class="form-row">
                    <select class="custom-select statusSelect" onchange="atualizarResponsavel(this,'<%= JSON.stringify(denuncia)%>')">
                      <option disabled <% if(!denuncia.responsavel){%> selected <%}%>>Nenhum</option>
                      <%usuarios.forEach(usuario => { %>
                        <option <% if(usuario.nome == denuncia.responsavel){%> selected <%}%>> <%= usuario.nome %> </option>
                      <% }); %>
                    </select>
                  </div>
                </form>
              </td>
              <td>
                <%= denuncia.datahoraSubmissao.toISOString().replace(/T/, ' ').replace(/\..+/, '') %>
              </td>
              <td class="align-middle">
                <%= denuncia.descricao%>
              </td>
              <td class="align-middle">
                <form>
                  <div class="form-row">
                    <select class="custom-select statusSelect" onchange="atualizarVisibilidade(this,'<%= JSON.stringify(denuncia) %>')">
                      <option <% if(denuncia.visibilidade == 0){%> selected <%}%> value="0">Apenas Comissão</option>
                      <option <% if(denuncia.visibilidade == 1){%> selected <%}%> value="1">Pública</option>
                    </select>
                  </div>
                </form>
              </td>
              <td class="statusFormat align-middle">
                <form>
                  <div class="form-row">
                    <select class="custom-select statusSelect" onchange="atualizarStatus(this,'<%= JSON.stringify(denuncia) %>')">
                      <option disabled <% if(denuncia.status == 0){%> selected <%}%> value="0">Cancelada</option>
                      <option <% if(denuncia.status == 1){%> selected <%}%> value="1">Submetida</option>
                      <option <% if(denuncia.status == 2){%> selected <%}%> value="2">Em Revisão</option>
                      <option <% if(denuncia.status == 3){%> selected <%}%> value="3">Aprovada</option>
                      <option <% if(denuncia.status == 4){%> selected <%}%> value="4">Solucionada</option>
                    </select>
                  </div>
                </form>
              </td>
              <td class="align-middle"><%= denuncia.observacao || "Sem observação"%></td>
            </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
 </div>

 <div class="teste"></div>


 <script>
     function atualizarResponsavel(selectObj, denuncia){
       let denunciaModificada = JSON.parse(denuncia);
       denunciaModificada.responsavel = selectObj.value;
       $.post("/" + denunciaModificada.id, denunciaModificada);
     }

     function atualizarStatus(selectObj, denuncia) {
         let denunciaModificada = JSON.parse(denuncia);
         denunciaModificada.status = selectObj.value;
         $.post("/" + denunciaModificada.id, denunciaModificada);
     }

     function atualizarVisibilidade(selectObj, denuncia) {
         let denunciaModificada = JSON.parse(denuncia);
         denunciaModificada.visibilidade = selectObj.value;
         $.post("/" + denunciaModificada.id, denunciaModificada);
     }

     function filtrar(){
       let filtros ={
         status : $("#formStatusmyInput").val(),
         data: $("#formStatus").val()
       }
       $.get("/admin/home?status="+filtros.status+"&data="+filtros.data, (data, status)=>{
         if(status == "success"){
           let tabela = $(data).find('#tabelaDenuncias').html();
           $("#tabelaDenuncias").html(tabela);
         }
       });
     }
</script>
